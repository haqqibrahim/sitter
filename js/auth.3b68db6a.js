(window.webpackJsonp=window.webpackJsonp||[]).push([["auth"],{M9A3:function(e,a,o){"use strict";o.r(a);var t=o("EVdn"),n=o.n(t);document.getElementById("login_facebook_div"),document.getElementById("signup_facebook_div");function i(e,a){const o=e[0].address_components.find(e=>e.types.includes(a));return o&&o.short_name}function s(e,a){(new google.maps.Geocoder).geocode({address:e},(e,o)=>{if(o===google.maps.GeocoderStatus.OK){const o=i(e,"country"),t=i(e,"administrative_area_level_1");let n;n="NZ"===o?i(e,"sublocality_level_1")||i(e,"sublocality"):i(e,"administrative_area_level_3")||i(e,"locality");const s=e[0].geometry.location.lat(),l=e[0].geometry.location.lng(),r={formatted:e[0].formatted_address,city:n,state:t,country:o,lat:s,lng:l};sittr_log(r),a(r)}else sittr_log("Geocode was not successful for the following reason: "+o)})}function l(){FB.api("/me?fields=email,first_name,last_name,location,gender",e=>{let a=!1,o=!1;sittr_log(e),a=void 0!==e.location,o=void 0!==e.email,o&&a?s(e.location.name,a=>{n.a.post("/login/facebook",{firstname:e.first_name,lastname:e.last_name,email:e.email,gender:e.gender,fbid:e.id,formatted_address:a.formatted,city:a.city,state:a.state,country:a.country,lat:a.lat,lng:a.lng},e=>{if(200===e)if("/sit"===window.location.pathname)window.location.replace("/sittr/new/1");else{let e=n()("#loginModal").data("redirect");e||(e="/sittrs"),window.location.replace(e)}else window.location.replace("/")})}):a?s(e.location.name,a=>{n()("#fb_signup_error").removeClass("hide"),n()("#login_facebook").html('<span class="fab fa-facebook-f"></span>Sign up with Facebook'),n()("#signup_address_formatted").val(a.formatted),n()("#signup_address_city").val(a.city),n()("#signup_address_state").val(a.state),n()("#signup_address_country").val(a.country),n()("#signup_address_lat").val(a.lat),n()("#signup_address_lng").val(a.lng),n()("#signup_firstname").val(e.first_name),n()("#signup_lastname").val(e.last_name),n()("#signup_email").val(e.email)}):(n()("#login_facebook").html('<span class="fab fa-facebook-f"></span>Sign up with Facebook'),n()("#fb_signup_error").removeClass("hide"),n()("#signup_firstname").val(e.first_name),n()("#signup_lastname").val(e.last_name),n()("#signup_email").val(e.email))})}function r(e){"connected"===e.status?"/account"===window.location.pathname||"/sittr/new/5"===window.location.pathname||"/profile"===window.location.pathname?FB.api("/me?fields=email,first_name,last_name",e=>{n.a.post("/trust/facebook/checkuser",{firstname:e.first_name,lastname:e.last_name,email:e.email},a=>{"error"===a.firstname||"error"===a.lastname||"error"===a.email||"duplicate"===a.email?("duplicate"===a.email?(n()("#fb_email_duplicate").removeClass("hide"),n()("#fb_save").addClass("hide")):(n()("#fb_main").removeClass("hide"),"error"===a.firstname&&(n()("#fb_firstname").removeClass("hide"),n()("#fb_firstname_field").text(e.first_name)),"error"===a.lastname&&(n()("#fb_lastname").removeClass("hide"),n()("#fb_lastname_field").text(e.last_name)),"error"===a.email&&(n()("#fb_email").removeClass("hide"),n()("#fb_email_field").text(e.email))),n()("#verify_facebook_modal").modal("show")):n.a.get("/trust/facebook/confirm",e=>{n()("#verify_facebook").html("verified"),n()("#verify_facebook").addClass("btn-verified"),n()("#verify_facebook").removeClass("btn-pending")})},"json").fail(()=>{})}):"/join"===window.location.pathname?(n()("#login_facebook").html('<span class="fab fa-facebook-f"></span>Sign up with Facebook&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i class="fas fa-circle-notch fa-spin"></i>'),l()):(n()("#login_facebook").html('<span class="fab fa-facebook-f"></span>Log in with Facebook&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i class="fas fa-circle-notch fa-spin"></i>'),l()):e.status}window.fbAsyncInit=function(){"stage.sittr.com"===window.location.hostname?FB.init({appId:"906110676094181",cookie:!0,xfbml:!1,autoLogAppEvents:!0,version:"v8.0"}):"localhost"===window.location.hostname?FB.init({appId:"768837399821510",cookie:!0,xfbml:!1,autoLogAppEvents:!0,version:"v8.0"}):FB.init({appId:"768836143154969",cookie:!0,xfbml:!1,autoLogAppEvents:!0,version:"v8.0"})},function(e,a,o){let t;const n=e.getElementsByTagName(a)[0];e.getElementById(o)||(t=e.createElement(a),t.id=o,t.src="//connect.facebook.net/en_US/sdk.js",n.parentNode.insertBefore(t,n))}(document,"script","facebook-jssdk"),n()("#login_facebook").click(()=>{FB.login(e=>{sittr_log(e),r(e)},{scope:"public_profile,email,user_location",auth_type:"rerequest"})}),n()("#signup_facebook").click(()=>{FB.login(e=>{sittr_log(e),r(e)},{scope:"public_profile,email,user_location",auth_type:"rerequest"})})}},[["M9A3","runtime",0]]]);